syntax = "proto3";

import "google/protobuf/timestamp.proto";

service Messager {
  rpc subscribeMessages(receiveMessagesRequest) returns (stream Message) {};
  rpc sendMessage(Message) returns (sendMessageResult) {};
  rpc getContacts(contactsRequest) returns (contactList) {};
  rpc messageSeen(updateSeen) returns (updateSeenResult) {};
}

message receiveMessagesRequest {
  bool request = 1;
}

message Message {
  string sender = 1;
  string receiver = 2;
  string content = 3;
  int32 messageId = 4;
  google.protobuf.Timestamp sent_at = 5;
  optional google.protobuf.Timestamp seen_at = 2;
}

message updateSeen {
  int32 messageId = 1;
  google.protobuf.Timestamp seen_at = 2;
}

message updateSeenResult {
  bool success = 1;
}

message sendMessageResult {
  bool sendSuccessful = 1;
  int32 message_id = 2;
}

message contactsRequest {
  bool request = 1;
}

message contact {
  string name = 1;
}

message contactList {
  repeated contact contacts = 1;
}
