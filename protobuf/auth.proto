syntax = "proto3";

service QuackMessageAuth {
  rpc Login (LoginMessage) returns (LoginResult) {};
  rpc CreateUser (CreateUserMessage) returns (CreateUserResult) {};
  rpc VerifyEmail (VerifyEmailMessage) returns (VerificationEmailSent) {};
  rpc CheckCode (VerificationCodeMessage) returns (VerificationCodeMatches) {};
  rpc CheckVersion (ClientVersion) returns (ValidVersion) {};
}

message ClientVersion {
  float version = 1;
}

message ValidVersion {
  bool valid = 1;
  float valid_version_num = 2;
}

// For Login
// Argon2 hashes password on server so hash doesn't become the password
message LoginMessage {
  string username = 1;
  string password = 2;
}

message LoginResult {
  bool success = 1;
  string auth_token = 2;
}


// Same as login, can add more info

message VerifyEmailMessage {
  string email = 1;
}

message VerificationEmailSent {
  bool emailSent = 1;
}

message VerificationCodeMessage {
  int32 code = 1;
  string email = 2;
}

message VerificationCodeMatches {
  bool verified = 1;
}

message CreateUserMessage {
  string username = 1;
  string password = 2;
  string email = 3;
}

message CreateUserResult {
  bool success = 1;
  string auth_token = 2;
}
